<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Atoms demo â€” dynamic fn registry</title>
    </head>
    <body>
        <link rel="stylesheet" href="./src/style.css" />
        <script type="module">
            import './src/Lib/BaseComponent/baseComponent.ts';
            import themeData from './dataUtils/themeData.ts';
            import sampleMegaDemoJson from './dataUtils/sampleMegaDemo.ts';

            function getCookie(key) {
                const name = encodeURIComponent(key) + '=';
                const parts = document.cookie.split(';');
                for (let part of parts) {
                    part = part.trim();
                    if (part.startsWith(name)) {
                        return decodeURIComponent(part.slice(name.length));
                    }
                }
                return null;
            }

            const rootElement = document.createElement('base-ui-element');
            rootElement.registry = new Map();

            const username = getCookie('userName');
            const password = getCookie('password');

            rootElement.plan = sampleMegaDemoJson;
            document.body.appendChild(rootElement);
            rootElement.designSystemService.register('Core', themeData);

            async function init() {
                if (username && password) {
                    rootElement.routerService.navigate('/');
                } else {
                    rootElement.routerService.emptyPathToRestore();
                    rootElement.routerService.navigate('/login');
                }
            }

            init();
        </script>
    </body>
</html>
